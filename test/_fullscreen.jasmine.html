<!DOCTYPE html>
<html>
<head>
  <title>Fotorama test</title>

  <link rel="stylesheet" type="text/css" href="jasmine-1.2.0/jasmine.css">
  <script type="text/javascript" src="jasmine-1.2.0/jasmine.js"></script>
  <script type="text/javascript" src="jasmine-1.2.0/jasmine-html.js"></script>

  <!-- Tests -->
  <script>
    describe('Fullscreen', function () {
	    var $window, $fotorama, fotorama, startPosition, startDimensions, fullscreenPosition;

			beforeEach(function() {
				$window = $window || $(window);
		    $fotorama = $fotorama || $('#fotorama');
		    fotorama = fotorama || $fotorama.data('fotorama');
		    jasmine.Clock.useMock();
		  });

	    describe('requestFullScreen', function () {

		    it('correct position on start', function () {
			    startPosition = $fotorama.position();
			    startDimensions = {width: $fotorama.width(), height: $fotorama.height()};
			    expect(startPosition.left).toEqual(Number($fotorama.css('left').replace(/px$/, '')));
		      expect(startPosition.top).toEqual(Number($fotorama.css('top').replace(/px$/, '')));
		    });

		    it('no fullscreen if it is not allowed yet', function () {
			    fotorama.requestFullScreen();
			    jasmine.Clock.tick(100);
			    expect($fotorama.hasClass('fotorama--fullscreen')).toBeFalsy();
		    });

		    it('fullscreen is opened', function () {
			    // allow fullscreen
		      fotorama.setOptions({allowFullScreen: true});
//
//		    // try again
		      fotorama.requestFullScreen();
		      jasmine.Clock.tick(100);
//
//		    // fullscreen is here
			    expect($fotorama.hasClass('fotorama--fullscreen')).toBeTruthy();
		    });
//
		    it('size & position are correct', function () {
			    fullscreenPosition = $fotorama.position();
			    expect($fotorama.width()).toEqual($window.width());
			    expect($fotorama.height()).toEqual($window.height());
			    expect(fullscreenPosition.left).toEqual(0);
			    expect(fullscreenPosition.top).toEqual(0);
		    });
	    });

	    describe('cancelFullscreen', function () {
		    it('fullscreen is cancelled', function () {
			    fotorama.cancelFullScreen();
			    jasmine.Clock.tick(100);
			    expect($fotorama.hasClass('fotorama--fullscreen')).toBeFalsy();
		    });

		    it('size & position are back and correct', function () {
			    expect({width: $fotorama.width(), height: $fotorama.height()}).toEqual(startDimensions);
			    expect($fotorama.position()).toEqual(startPosition);
		    });
	    });
    });

  </script>

  <!-- What to test -->
  <script src="jquery/jquery-1.10.1.min.js"></script>
  <script src="../product/fotorama.js"></script>
	<link rel="stylesheet" href="../product/fotorama.css"/>

  <!-- Jasmine initialization (why it here?) -->
  <script type="text/javascript">
    (function() {
      var jasmineEnv = jasmine.getEnv();
      jasmineEnv.updateInterval = 1000;

      var htmlReporter = new jasmine.HtmlReporter();

      jasmineEnv.addReporter(htmlReporter);

      jasmineEnv.specFilter = function(spec) {
        return htmlReporter.specFilter(spec);
      };

      var currentWindowOnload = window.onload;

      window.onload = function() {
        if (currentWindowOnload) {
          currentWindowOnload();
        }
        execJasmine();
      };

      function execJasmine() {
        jasmineEnv.execute();
      }
    })();
  </script>

</head>
<body>

<div style="position: relative; width: 717px; height: 509px;">

<!-- Fotorama -->
<div class="fotorama" id="fotorama" style="position: absolute; top: 12px; left: 17px;">
	<img src="i/okonechnikov/1-lo.jpg">
	<img src="i/okonechnikov/2-lo.jpg">
	<img src="i/okonechnikov/9-lo.jpg">
	<img src="i/okonechnikov/6-lo.jpg">
	<img src="i/okonechnikov/5-lo.jpg">
</div>

</div>

</body>
</html>